[![Version](https://img.shields.io/packagist/v/creasi/laravel-project?style=flat-square)](https://packagist.org/packages/creasi/laravel-project)
[![License](https://img.shields.io/packagist/l/creasi/laravel-project?style=flat-square)](https://github.com/creasico/laravel-project/blob/master/LICENSE)
[![Actions Status](https://img.shields.io/github/workflow/status/creasico/laravel-project/Code%20Quality/master?style=flat-square&logo=github-actions)](https://github.com/creasico/laravel-project/actions)

# Application Skeleton

## Requirements

- PHP `>= v8.0` and Composer `>= v2.0`
- Node.js `>= v16.0` and PNPM `v7.x`
- Database Server (MySQL, MariaDB or PostgreSQL)

## Setup

1. Clone the repository & `cd` into it
   ```sh
   $ git clone git@github.com:creasico/skeleton.git <dir-name>
   $ cd <dir-name>
   ```
2. Install dependencies
   ```sh
   $ composer install
   $ pnpm install
   ```
3. Copy `.env.example` file to `.env` file & generate new app key
   ```sh
   $ php artisan key:generate
   ```
4. Create new database & make sure to update `.env` file accordingly
   ```sh
   # for MySQL (presumably you've already have mysql client)
   $ mysql -e 'create database <db-name>'

   # for PostgreSQL (presumably you've already have postgresql client)
   $ createdb <db-bame>
   ```

5. You're good to go

## Testing

It's recommended to spare another database for testing purposes, so once you run the tests it doesn't interfere your development database at all. There's few steps to achieve this

1. Make `.env.testing` file based on your current `.env` file, like this

   ```sh
   $ cp .env .env.testing
   $ touch database/database.sqlite
   ```

2. Then update your `DB_*` variables as you desire for testing. Then, duplicate one of your `database.connections` config and rename the key with value of `DB_CONNECTION` in your `.env.testing` file. Say you were using postgres, simply copy

   ```php
   'connections' => [
        'pgsql' => [
            'driver' => 'pgsql',
            // your current db config
        ],

        'testing' => [
            'driver' => 'pgsql',
            // db config for testing
        ],
   ]
   ```

   Same thing's happends for mysql, or any other database you were using for this project.

To simplify the process feel free to use `sqlite` for our testing, but please note that using different database driver for different environment can cause problems. So it's recommended to use same database driver for all environments.

Last but not least, for `pgsql` connection, this project is pre-configured with same database but different schema for testing. Feel free to reconfigure it once you setup new project based on this skeleton.

Now you're good to go. For more information please consult to the [official documentation](https://laravel.com/docs/9.x/testing#environment).

## Development

### Front-end

This project is using `windi.css` and `alpine.js` as default front-end library, which mean any changes you've made, won't appears immadiately unless you run the following command

```sh
$ pnpm dev
```

So, please make sure you've already install the dependencies as stated in the [Setup](#setup) section above.

### Container

In-case you're willing to work with Docker, this project already pre-configured with [`laravel/sail`](https://laravel.com/docs/sail) and [devcontainer](https://containers.dev). 
   
Feel free to reconfigure `laravel/sail` as your project desire by running following command:

```sh
$ php artisan sail:install
```

And choose all the required services for your current project. Now, you'll need to run the project with following command:

```sh
$ ./vendor/bin/sail up [-d]
```

For more information please consult to the [official documentation](https://laravel.com/docs/sail).

Another option is using `devcontainer` which is basically using same configuration based on [`docker-compose.yml`](docker-compose.yml) that generated by `laravel/sail`. Here you have the option to install `devcontainer-cli` from `npm` as described in [their documentation](https://code.visualstudio.com/docs/remote/devcontainer-cli#_npm-install) or use one that come with [Remote Container Extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers) via command palete (<kbd>CTRL + SHIFT + P</kbd> for PC or <kbd>CMD + SHIFT + P</kbd> for MAC) then type `install devcontainer cli`.

Once you've done installing `devcontainer-cli` you can run

```sh
devcontainer up [-d]
```

Either `laravel/sail`, `devcontainer-cli` or even `docker compose` has similar command in term of build and running the service, one exception is `devcontainer-cli` doesn't provide shutdown command which `laravel/sail` does provide.

Please avoid using native `docker compose up` to run the container, even tho `laravel/sail` and `devcontainer-cli` are basically runs `docker compose` under neath, but they does provide additional argument to make it more managable. Notice that `-d` flag above works the same for either `sail up -d` and `devcontainer up -d`, which is to make the service runs in background.

That being said, you're free to use either `docker compose down` or `./vendor/bin/sail down` to shutdown the service.

**NOTES**:
- **Commit Convention**: This project follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) using [@commitlint/config-conventional](https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-conventional) as standart, so make sure you follow the rules.
- **Code Style**: This project uses [`PSR12`](https://www.php-fig.org/psr/psr-12/) code standard and [`@antfu/eslint-config`](https://github.com/antfu/eslint-config), so make sure you follow the rules. But don't worry, your VSCode should handle it for you. Please consult to [this config](.vscode/settings.json) for more info.

## License

The Application will be open-sourced software licensed under the [MIT license](https://opensource.org/licenses/MIT).
