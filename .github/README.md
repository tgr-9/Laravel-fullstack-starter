[![Version](https://img.shields.io/packagist/v/creasi/project)](https://packagist.org/packages/creasi/project)
[![License](https://img.shields.io/packagist/l/creasi/project)](https://github.com/creasico/laravel-project/blob/master/LICENSE)
[![Actions Status](https://github.com/creasico/laravel-project/actions/workflows/main.yml/badge.svg)](https://github.com/creasico/laravel-project/actions)

# Application Skeleton

## Requirements

- PHP `>= v8.0` and Composer `>= v2.0`
- Node.js `>= v16.0` and PNPM `v7.x`
- Database Server (MySQL, MariaDB or PostgreSQL)

## Setup

1. Clone the repository & `cd` into it
   ```sh
   $ git clone git@github.com:creasico/skeleton.git <dir-name>
   $ cd <dir-name>
   ```
2. Install dependencies
   ```sh
   $ composer install
   $ pnpm install
   ```
3. Copy `.env.example` file to `.env` file & generate new app key
   ```sh
   $ php artisan key:generate
   ```
4. Create new database & make sure to update `.env` file accordingly
   ```sh
   # for MySQL (presumably you've already have mysql client)
   $ mysql -e 'create database <db-name>'

   # for PostgreSQL (presumably you've already have postgresql client)
   $ createdb <db-bame>
   ```

5. You're good to go

## Development

### Front-end

This project is using `windi.css` and `alpine.js` as default front-end library, which mean any changes you've made, won't appears immadiately unless you run the following command

```sh
$ pnpm dev
```

So, please make sure you've already install the dependencies as stated in the [Setup](#setup) section above.

### Container

In-case you're willing to work with Docker, this project already pre-configured with [`laravel/sail`](https://laravel.com/docs/sail) and [devcontainer](https://containers.dev). But before you begin you'll need to copy your `.env` file to `.env.dev` then remove the `APP_ENV` line, that way you can differentiate environment configuration between your local machine and in containerized machine.

1. Using Laravel Sail

   Feel free to reconfigure `laravel/sail` as your project desire by running following command:

   ```sh
   $ php artisan sail:install
   ```

   And choose all the required services for your current project. Now, you'll need to run the project with following command:

   ```sh
   $ ./vendor/bin/sail up [-d]
   ```

   For more information please consult to the [official documentation](https://laravel.com/docs/sail).

2. Using DevContainer

   Another option is using `devcontainer` which is basically using same configuration based on [`docker-compose.yml`](docker-compose.yml) that generated by `laravel/sail`. Here you have the option to install `devcontainer-cli` from `npm` as described in [their documentation](https://code.visualstudio.com/docs/remote/devcontainer-cli#_npm-install) or use one that come with [Remote Container Extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers) via command palete (<kbd>CTRL + SHIFT + P</kbd> for PC or <kbd>CMD + SHIFT + P</kbd> for MAC) then type `install devcontainer cli`.

   Once you've done installing `devcontainer-cli` you can run

   ```sh
   devcontainer up [-d]
   ```

   Either `laravel/sail`, `devcontainer-cli` or even `docker compose` has similar command in term of build and running the service, one exception is `devcontainer-cli` doesn't provide shutdown command which `laravel/sail` does provide.

Please avoid using native `docker compose up` to run the container, even tho `laravel/sail` and `devcontainer-cli` are basically runs `docker compose` under the hood, but they does provide additional argument to make it more managable.
Notice that `-d` flag above works the same for either `sail up -d` and `devcontainer up -d`, which is to make the service runs in background.

That being said, you're free to use either `docker compose down` or `./vendor/bin/sail down` to shutdown the service.

## Testing

This skeleton is already have pre-configured for testing using built-in and official testing utility of Laravel Framework, which is `phpunit` and `laravel dusk`.

All we need to do is updating our `database.connections.testing` to the project requirement, meaning if you were working with `postgres` nothing you need to do, but if you were working with `mysql` make sure you have already update the configs.

That being said, you'll need to spare another database for testing purposes, so once you run the tests it doesn't interfere your development database at all. For more information please consult to the [official documentation](https://laravel.com/docs/9.x/testing#environment).

```sh
$ php artisan test        # to run unit test
$ ./vendor/bin/sail test  # if you want to run test in sail environment
```

### Laravel Dusk

Before you begin tests using laravel dusk, please make sure you've already install the webdriver with the following command

```sh
$ php artisan dusk:install
```

By default that command will install the latest ChromeDriver meaning you'll have to make sure that the installed version of ChromeDriver matches with version of your locally installed Google Chrome, then run

```sh
$ php artisan dusk        # to run integration test, OR
$ ./vendor/bin/sail dusk  # if you want to run dusk in sail environment
```

By default laravel dusk will runs headlessly, if you willing to disable headless mode, just comment out `DUSK_HEADLESS_DISABLED` in your `.env` file. For more info please consult to the [official documentation](https://laravel.com/docs/dusk)

## Notes
- **Commit Convention**: This project follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) using [@commitlint/config-conventional](https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-conventional) as standart, so make sure you follow the rules.
- **Code Style**: This project uses [`PSR12`](https://www.php-fig.org/psr/psr-12/) code standard and [`@antfu/eslint-config`](https://github.com/antfu/eslint-config), so make sure you follow the rules. But don't worry, your VSCode should handle it for you. Please consult to [this config](.vscode/settings.json) for more info.

## Sponsors

[![BrowserStack Logo](https://raw.githubusercontent.com/creasico/creasico.github.io/master/public/assets/browserstack-logo.png)](https://browserstack.com)

## License

The project is an open-source software licensed under the [MIT license](https://opensource.org/licenses/MIT).
